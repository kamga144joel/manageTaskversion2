{"version":3,"file":"tache-QPAfRcOk.js","sources":["../../../../pages/tache.vue"],"sourcesContent":["<template>\n  <div class=\"container mx-auto px-4 py-8\">\n    <AnimatedTransition transitionName=\"fade\">\n      <h1 class=\"text-2xl font-bold text-red-600 underline text-center mb-8\">Gestion des tâches</h1>\n    </AnimatedTransition>\n\n    <!-- Formulaire d'ajout de tâche -->\n    <AnimatedTransition transitionName=\"slide\">\n      <div class=\"bg-white rounded-lg shadow-md p-6 mb-8\">\n        <h2 class=\"text-xl font-semibold mb-4\">Ajouter une tâche</h2>\n        <form @submit.prevent=\"handleAddTache\">\n          <div class=\"space-y-4\">\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">Titre:</label>\n              <input \n                v-model=\"title\" \n                type=\"text\" \n                placeholder=\"Titre\"\n                class=\"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-slate-600 transition-all duration-200\"\n                required\n              />\n            </div>\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">Description:</label>\n              <input \n                v-model=\"description\" \n                type=\"text\" \n                placeholder=\"Description\"\n                class=\"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-slate-600 transition-all duration-200\"\n                required\n              />\n            </div>\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">Propriétaire:</label>\n              <input \n                v-model=\"owner\" \n                type=\"text\" \n                placeholder=\"Propriétaire\"\n                class=\"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-slate-600 transition-all duration-200\"\n                required\n              />\n            </div>\n            <div class=\"flex justify-end\">\n              <button \n                type=\"submit\"\n                class=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-all duration-200 shadow-sm hover:shadow-md\"\n              >\n                Ajouter\n              </button>\n            </div>\n          </div>\n        </form>\n\n        <AnimatedTransition transitionName=\"fade\">\n          <p v-if=\"addTacheLoading\" class=\"mt-4 text-blue-500\">Ajout en cours...</p>\n        </AnimatedTransition>\n        <AnimatedTransition transitionName=\"fade\">\n          <p v-if=\"addTacheError\" class=\"mt-4 text-red-500\">Une erreur s'est produite : {{ addTacheError.message }}</p>\n        </AnimatedTransition>\n      </div>\n    </AnimatedTransition>\n\n    <!-- Liste des tâches -->\n    <AnimatedTransition transitionName=\"slide\">\n      <div class=\"bg-white rounded-lg shadow-md p-6\">\n        <h2 class=\"text-xl font-semibold mb-4\">Liste des tâches</h2>\n        \n        <div class=\"text-center py-4\">\n          <AnimatedTransition transitionName=\"fade\">\n            <div v-if=\"loading\" class=\"text-center py-4\">\n              <div class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto\"></div>\n            </div>\n            <div v-else-if=\"error\" class=\"text-center py-4\">\n              <p class=\"text-red-500\">Une erreur s'est produite : {{ error.message }}</p>\n            </div>\n            <div v-else-if=\"taches.length === 0\" class=\"text-center py-4\">\n              <p class=\"text-gray-500\">Aucune tâche trouvée.</p>\n            </div>\n            <AnimatedTransition v-else transitionName=\"slide\">\n              <div class=\"overflow-x-auto\">\n                <table class=\"min-w-full divide-y divide-gray-200\">\n                  <thead class=\"bg-gray-50\">\n                    <tr>\n                      <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Propriétaire</th>\n                      <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Tâche</th>\n                      <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Description</th>\n                      <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Statut</th>\n                    </tr>\n                  </thead>\n                  <tbody class=\"bg-white divide-y divide-gray-200\">\n                    <AnimatedTransition transitionName=\"slide\" v-for=\"tache in taches\" :key=\"tache.title\">\n                      <tr class=\"transition-all duration-200 hover:bg-gray-50\">\n                        <td class=\"px-6 py-4 whitespace-nowrap\">\n                          <AnimatedTransition transitionName=\"fade\">\n                            <span>{{ tache.owner.name }} {{ tache.owner.username }}</span>\n                          </AnimatedTransition>\n                        </td>\n                        <td class=\"px-6 py-4 whitespace-nowrap\">\n                          <AnimatedTransition transitionName=\"fade\">\n                            <span>{{ tache.title }}</span>\n                          </AnimatedTransition>\n                        </td>\n                        <td class=\"px-6 py-4 whitespace-nowrap\">\n                          <AnimatedTransition transitionName=\"fade\">\n                            <span>{{ tache.description }}</span>\n                          </AnimatedTransition>\n                        </td>\n                        <td class=\"px-6 py-4 whitespace-nowrap\">\n                          <AnimatedTransition transitionName=\"fade\">\n                            <span :class=\"[\n                              'px-2 inline-flex text-xs leading-5 font-semibold rounded-full transition-all duration-200',\n                              tache.completed ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'\n                            ]\">\n                              {{ tache.completed ? 'Terminée' : 'En cours' }}\n                            </span>\n                          </AnimatedTransition>\n                        </td>\n                      </tr>\n                    </AnimatedTransition>\n                  </tbody>\n                </table>\n              </div>\n            </AnimatedTransition>\n          </AnimatedTransition>\n        </div>\n      </div>\n    </AnimatedTransition>\n  </div>\n</template>\n\n<script setup>\nimport { ref, watch, onMounted } from 'vue'\nimport AnimatedTransition from '~/components/AnimatedTransition.vue'\nimport { useQuery, useMutation } from '@vue/apollo-composable'\nimport { gql } from 'graphql-tag'\n\n// États du formulaire\nconst title = ref('')\nconst description = ref('')\nconst owner = ref('')\nconst loading = ref(false)\nconst error = ref(null)\nconst taches = ref([])\n\n// Requêtes GraphQL\nconst GET_TACHES_QUERY = gql`\n  query GetTaches {\n    taches {\n      collection {\n        title\n        description\n        completed\n        owner {\n          name\n          username\n          email\n        }\n      }\n    }\n  }\n`\n\nconst ADD_TACHE_MUTATION = gql`\n  mutation CreateTache($title: String!, $description: String!, $owner: String!) {\n    createTache(\n      title: $title,\n      description: $description,\n      owner: $owner,\n      completed: false\n    ) {\n      title\n      description\n      completed\n      owner {\n        name\n        username\n        email\n      }\n    }\n  }\n`\n\n// Utilisation des mutations et requêtes\nconst { mutate: addTache, loading: addTacheLoading, error: addTacheError } = useMutation(ADD_TACHE_MUTATION)\nconst { result, loading: queryLoading, error: queryError } = useQuery(GET_TACHES_QUERY)\n\nwatch(result, (newValue) => {\n  if (newValue?.taches?.collection) {\n    // Pas besoin de réaffecter les données à un nouveau ref\n    taches.value = newValue.taches.collection\n  }\n})\n\nonMounted(() => {\n  loading.value = true\n  error.value = null\n})\n\n// Fonction pour gérer l'ajout de tâche\nconst handleAddTache = async () => {\n  if (!title.value || !description.value || !owner.value) return\n\n  try {\n    await addTache({\n      title: title.value,\n      description: description.value,\n      owner: owner.value\n    })\n    \n    // Réinitialiser les champs\n    title.value = ''\n    description.value = ''\n    owner.value = ''\n  } catch (err) {\n    console.error('Erreur lors de l\\'ajout de la tâche:', err)\n    addTacheError.value = err\n  }\n}\n</script>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyIA,UAAM,QAAQ,IAAI,EAAE;AACpB,UAAM,cAAc,IAAI,EAAE;AAC1B,UAAM,QAAQ,IAAI,EAAE;AACpB,UAAM,UAAU,IAAI,KAAK;AACzB,UAAM,QAAQ,IAAI,IAAI;AACtB,UAAM,SAAS,IAAI,CAAE,CAAA;AAGrB,UAAM,mBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBzB,UAAM,qBAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAqB3B,UAAM,EAAE,QAAQ,UAAU,SAAS,iBAAiB,OAAO,cAAa,IAAK,YAAY,kBAAkB;AAC3G,UAAM,EAAE,OAAiD,IAAI,SAAS,gBAAgB;AAEtF,UAAM,QAAQ,CAAC,aAAa;;AAC1B,WAAI,0CAAU,WAAV,mBAAkB,YAAY;AAEhC,eAAO,QAAQ,SAAS,OAAO;AAAA,MACnC;AAAA,IACA,CAAC;AAQD,UAAM,iBAAiB,YAAY;AACjC,UAAI,CAAC,MAAM,SAAS,CAAC,YAAY,SAAS,CAAC,MAAM,MAAO;AAExD,UAAI;AACF,cAAM,SAAS;AAAA,UACb,OAAO,MAAM;AAAA,UACb,aAAa,YAAY;AAAA,UACzB,OAAO,MAAM;AAAA,QACd,CAAA;AAGD,cAAM,QAAQ;AACd,oBAAY,QAAQ;AACpB,cAAM,QAAQ;AAAA,MACf,SAAQ,KAAK;AACZ,gBAAQ,MAAM,uCAAwC,GAAG;AACzD,sBAAc,QAAQ;AAAA,MAC1B;AAAA,IACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}