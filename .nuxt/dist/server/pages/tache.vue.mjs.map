{"version":3,"file":"tache.vue.mjs","sources":["../../../../pages/tache.vue"],"sourcesContent":["<template>\n  <div class=\"container mx-auto px-4 py-8\">\n    <h1 class=\"text-2xl font-bold text-red-600 underline text-center mb-8\">Gestion des tâches</h1>\n\n    <!-- Formulaire d'ajout de tâche -->\n    <div class=\"bg-white rounded-lg shadow-md p-6 mb-8\">\n      <h2 class=\"text-xl font-semibold mb-4\">Ajouter une tâche</h2>\n      <form @submit.prevent=\"handleAddTache\">\n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">Titre:</label>\n            <input \n              v-model=\"title\" \n              type=\"text\" \n              placeholder=\"Titre\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-slate-600\"\n              required\n            />\n          </div>\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">Description:</label>\n            <input \n              v-model=\"description\" \n              type=\"text\" \n              placeholder=\"Description\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-slate-600\"\n              required\n            />\n          </div>\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">Propriétaire:</label>\n            <input \n              v-model=\"owner\" \n              type=\"text\" \n              placeholder=\"Propriétaire\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-slate-600\"\n              required\n            />\n          </div>\n          <div class=\"flex justify-end\">\n            <button \n              type=\"submit\"\n              class=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\n            >\n              Ajouter\n            </button>\n          </div>\n        </div>\n      </form>\n\n      <p v-if=\"addTacheLoading\" class=\"mt-4 text-blue-500\">Ajout en cours...</p>\n      <p v-if=\"addTacheError\" class=\"mt-4 text-red-500\">Une erreur s'est produite : {{ addTacheError.message }}</p>\n    </div>\n\n    <!-- Liste des tâches -->\n    <div class=\"bg-white rounded-lg shadow-md p-6\">\n      <h2 class=\"text-xl font-semibold mb-4\">Liste des tâches</h2>\n      \n      <div v-if=\"loading\" class=\"text-center py-4\">\n        <p class=\"text-yellow-600\">Chargement en cours...</p>\n      </div>\n      \n      <div v-else-if=\"error\" class=\"text-center py-4\">\n        <p class=\"text-red-600\">Une erreur s'est produite : {{ error.message }}</p>\n      </div>\n      \n      <div v-if=\"taches.length === 0\" class=\"text-center py-4\">\n        <p>Aucune tâche trouvée.</p>\n      </div>\n      \n      <div v-else class=\"overflow-x-auto\">\n        <table class=\"min-w-full divide-y divide-gray-200\">\n          <thead class=\"bg-gray-50\">\n            <tr>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Propriétaire</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Tâche</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Description</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">ID</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Statut</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Email</th>\n            </tr>\n          </thead>\n          <tbody class=\"bg-white divide-y divide-gray-200\">\n            <tr v-for=\"tache in taches\" :key=\"tache.id\">\n              <td class=\"px-6 py-4 whitespace-nowrap\">\n                {{ tache.owner.name }} {{ tache.owner.username }}\n              </td>\n              <td class=\"px-6 py-4 whitespace-nowrap\">\n                {{ tache.title }}\n              </td>\n              <td class=\"px-6 py-4 whitespace-nowrap\">\n                {{ tache.description }}\n              </td>\n              <td class=\"px-6 py-4 whitespace-nowrap\">\n                {{ tache.id }}\n              </td>\n              <td class=\"px-6 py-4 whitespace-nowrap\">\n                <span :class=\"[\n                  'px-2 inline-flex text-xs leading-5 font-semibold rounded-full',\n                  tache.completed ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'\n                ]\">\n                  {{ tache.completed ? 'Terminée' : 'En cours' }}\n                </span>\n              </td>\n              <td class=\"px-6 py-4 whitespace-nowrap\">\n                {{ tache.owner.email }}\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport { useQuery, useMutation } from '@vue/apollo-composable'\nimport { gql } from 'graphql-tag'\n\n// États du formulaire\nconst title = ref('')\nconst description = ref('')\nconst owner = ref('')\n\n// Requêtes GraphQL\nconst GET_TACHES_QUERY = gql`\n  query GetTaches {\n    taches {\n      id\n      title\n      description\n      completed\n      owner {\n        id\n        name\n        username\n        email\n      }\n    }\n  }\n`\n\nconst ADD_TACHE_MUTATION = gql`\n  mutation AddTache($title: String!, $description: String!, $owner: String!) {\n    addTache(\n      title: $title,\n      description: $description,\n      owner: $owner,\n      completed: false\n    ) {\n      id\n      title\n      description\n      completed\n      owner {\n        id\n        name\n        username\n        email\n      }\n    }\n  }\n`\n\n// Utilisation des mutations et requêtes\nconst { mutate: addTache, loading: addTacheLoading, error: addTacheError } = useMutation(ADD_TACHE_MUTATION)\nconst taches = ref([])\nconst loading = ref(true)\nconst error = ref(null)\n\nonMounted(async () => {\n  try {\n    const { data } = await useFetch('/api/taches')\n    taches.value = data.value.taches || []\n  } catch (err) {\n    error.value = err\n  } finally {\n    loading.value = false\n  }\n})\n\n// Fonction pour gérer l'ajout de tâche\nconst handleAddTache = async () => {\n  if (!title.value || !description.value || !owner.value) return\n\n  try {\n    await addTache({\n      title: title.value,\n      description: description.value,\n      owner: owner.value\n    })\n    \n    // Réinitialiser le formulaire\n    title.value = ''\n    description.value = ''\n    owner.value = ''\n  } catch (err) {\n    console.error('Erreur lors de l\\'ajout de la tâche:', err)\n    addTacheError.value = err\n  }\n}\n</script>\n\n\n"],"names":[],"mappings":";;;;;;;;;AAyHA,UAAM,QAAQ,IAAI,EAAE;AACpB,UAAM,cAAc,IAAI,EAAE;AAC1B,UAAM,QAAQ,IAAI,EAAE;AAGK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBzB,UAAM,qBAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAuB3B,UAAM,EAAoB,SAAS,iBAAiB,OAAO,cAAe,IAAG,YAAY,kBAAkB;AAC3G,UAAM,SAAS,IAAI,CAAE,CAAA;AACrB,UAAM,UAAU,IAAI,IAAI;AACxB,UAAM,QAAQ,IAAI,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}